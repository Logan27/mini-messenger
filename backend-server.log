2025-10-22T15:40:26.274Z sequelize:pool pool created with max/min: 10/2, no replication
‚úÖ Sequelize instance created for development environment
2025-10-22T15:40:26.315Z sequelize:hooks adding hook beforeCreate
2025-10-22T15:40:26.316Z sequelize:hooks adding hook beforeUpdate
2025-10-22T15:40:26.319Z sequelize:hooks adding hook beforeCreate
2025-10-22T15:40:26.321Z sequelize:hooks adding hook beforeCreate
2025-10-22T15:40:26.322Z sequelize:hooks adding hook beforeCreate
2025-10-22T15:40:26.322Z sequelize:hooks adding hook afterCreate
2025-10-22T15:40:26.323Z sequelize:hooks adding hook beforeCreate
2025-10-22T15:40:26.323Z sequelize:hooks adding hook beforeUpdate
2025-10-22T15:40:26.324Z sequelize:hooks adding hook afterUpdate
2025-10-22T15:40:26.326Z sequelize:hooks adding hook beforeCreate
2025-10-22T15:40:26.326Z sequelize:hooks adding hook afterCreate
2025-10-22T15:40:26.327Z sequelize:hooks adding hook beforeCreate
2025-10-22T15:40:26.327Z sequelize:hooks adding hook beforeUpdate
2025-10-22T15:40:26.329Z sequelize:hooks adding hook beforeCreate
2025-10-22T15:40:26.329Z sequelize:hooks adding hook beforeUpdate
2025-10-22T15:40:26.330Z sequelize:hooks adding hook beforeCreate
2025-10-22T15:40:26.815Z [[32minfo[39m]: Notification settings cache cleanup initialized
2025-10-22T15:40:26.817Z [[32minfo[39m]: Auto cleanup for expired notifications started
2025-10-22T15:40:27.011Z [[32minfo[39m]: Data retention job scheduled.
üìö Swagger UI will be available at /api-docs
üîß Starting server initialization...
üìù Initializing logger...
‚úÖ Logger initialized
üíæ Initializing database...
2025-10-22T15:40:27.070Z sequelize:connection:pg connection acquired
2025-10-22T15:40:27.096Z sequelize:connection:pg connection acquired
2025-10-22T15:40:27.098Z sequelize:pool connection acquired
2025-10-22T15:40:27.100Z sequelize:sql:pg Executing (default): SELECT 1
Executing (default): SELECT 1
2025-10-22T15:40:27.101Z sequelize:sql:pg Executed (default): SELECT 1
2025-10-22T15:40:27.101Z sequelize:pool connection released
‚úÖ Database connection established successfully.
‚ö†Ô∏è  Database sync disabled (models have naming inconsistencies)
‚úÖ Database initialized
üî¥ Initializing Redis...
‚úÖ Redis connection established successfully
‚úÖ Redis initialized
üì¶ Loading app.js...
üì¶ App.js loaded, initializing services...
2025-10-22T15:40:27.115Z [[32minfo[39m]: Upload directories created successfully
{
  "uploadDir": "./uploads",
  "tempDir": "./uploads/temp"
}
2025-10-22T15:40:27.116Z [[33mwarn[39m]: ‚ö†Ô∏è  ClamAV not available on Windows - virus scanning disabled for development
2025-10-22T15:40:27.116Z [[32minfo[39m]: File upload service initialized successfully
‚úÖ File upload service initialized
2025-10-22T15:40:27.116Z [[33mwarn[39m]: ‚ö†Ô∏è  Virus update service skipped on Windows (ClamAV not available)
2025-10-22T15:40:27.119Z [[32minfo[39m]: Generated fallback icon for document:
2025-10-22T15:40:27.120Z [[32minfo[39m]: Generated fallback icon for video:
2025-10-22T15:40:27.121Z [[32minfo[39m]: Generated fallback icon for audio:
2025-10-22T15:40:27.122Z [[32minfo[39m]: Generated fallback icon for archive:
2025-10-22T15:40:27.124Z [[32minfo[39m]: Generated fallback icon for code:
2025-10-22T15:40:27.125Z [[32minfo[39m]: Generated fallback icon for default:
2025-10-22T15:40:27.136Z [[32minfo[39m]: Daily thumbnail cleanup scheduled for 2:00 AM
2025-10-22T15:40:27.136Z [[32minfo[39m]: Thumbnail service initialized successfully
2025-10-22T15:40:27.138Z [[32minfo[39m]: File cleanup jobs scheduled
2025-10-22T15:40:27.139Z [[32minfo[39m]: File cleanup service initialized successfully
‚úÖ Services initialized
üöÄ Creating server...
üöÄ =====================================
üöÄ Messenger Backend Server
üöÄ =====================================
üìç Environment: development
üåê Server: http://0.0.0.0:4000
üìö API Docs: http://localhost:4000/api-docs
üè• Health: http://localhost:4000/health
‚è±Ô∏è  Started at: 2025-10-22T15:40:27.142Z
üöÄ =====================================

üîß Development Mode Features:
  ‚Ä¢ Hot reload enabled
  ‚Ä¢ Detailed error messages
  ‚Ä¢ Request logging enabled
  ‚Ä¢ CORS configured for local development
üöÄ =====================================
üöÄ Server running on 0.0.0.0:4000
üìö API Documentation available at http://localhost:4000/api-docs
üè• Health check available at http://localhost:4000/health
‚úÖ Message service initialized
üì° WebSocket server initialized with Redis adapter for scaling
‚úÖ WebSocket service initialized successfully
2025-10-22T15:40:29.561Z sequelize:pool connection acquired
2025-10-22T15:40:29.561Z sequelize:sql:pg Executing (default): SELECT 1
Executing (default): SELECT 1
2025-10-22T15:40:29.563Z sequelize:sql:pg Executed (default): SELECT 1
2025-10-22T15:40:29.563Z sequelize:pool connection released
[2025-10-22 17:40:29] [49b6217c-3227-4f9a-9387-3918d31ad50f] GET /health 200 - 20ms - GET /health
[0mGET /health [32m200[0m 18.298 ms - 768[0m
2025-10-22T15:40:44.583Z sequelize:pool connection acquired
2025-10-22T15:40:44.583Z sequelize:sql:pg Executing (default): SELECT "id", "username", "email", "passwordHash", "firstName", "lastName", "avatar", "bio", "phone", "status", "role", "approvalStatus", "approvedBy", "approvedAt", "rejectionReason", "emailVerified", "emailVerificationToken", "passwordResetToken", "passwordResetExpires", "failedLoginAttempts", "lockedUntil", "lastLoginAt", "publicKey", "createdAt", "updatedAt", "deletedAt" FROM "users" AS "User" WHERE ("User"."deletedAt" IS NULL AND ("User"."email" = 'admin' OR "User"."username" = 'admin')) LIMIT 1;
Executing (default): SELECT "id", "username", "email", "passwordHash", "firstName", "lastName", "avatar", "bio", "phone", "status", "role", "approvalStatus", "approvedBy", "approvedAt", "rejectionReason", "emailVerified", "emailVerificationToken", "passwordResetToken", "passwordResetExpires", "failedLoginAttempts", "lockedUntil", "lastLoginAt", "publicKey", "createdAt", "updatedAt", "deletedAt" FROM "users" AS "User" WHERE ("User"."deletedAt" IS NULL AND ("User"."email" = 'admin' OR "User"."username" = 'admin')) LIMIT 1;
2025-10-22T15:40:44.587Z sequelize:pool connection released
2025-10-22T15:40:44.700Z sequelize:pool connection acquired
2025-10-22T15:40:44.700Z sequelize:sql:pg Executing (default): SELECT "id", "username", "email", "passwordHash", "firstName", "lastName", "avatar", "bio", "phone", "status", "role", "approvalStatus", "approvedBy", "approvedAt", "rejectionReason", "emailVerified", "emailVerificationToken", "passwordResetToken", "passwordResetExpires", "failedLoginAttempts", "lockedUntil", "lastLoginAt", "publicKey", "createdAt", "updatedAt", "deletedAt" FROM "users" AS "User" WHERE ("User"."deletedAt" IS NULL AND ("User"."email" = 'admin' OR "User"."username" = 'admin')) LIMIT 1;
Executing (default): SELECT "id", "username", "email", "passwordHash", "firstName", "lastName", "avatar", "bio", "phone", "status", "role", "approvalStatus", "approvedBy", "approvedAt", "rejectionReason", "emailVerified", "emailVerificationToken", "passwordResetToken", "passwordResetExpires", "failedLoginAttempts", "lockedUntil", "lastLoginAt", "publicKey", "createdAt", "updatedAt", "deletedAt" FROM "users" AS "User" WHERE ("User"."deletedAt" IS NULL AND ("User"."email" = 'admin' OR "User"."username" = 'admin')) LIMIT 1;
2025-10-22T15:40:44.702Z sequelize:pool connection released
2025-10-22T15:40:44.856Z sequelize:pool connection acquired
2025-10-22T15:40:44.857Z sequelize:sql:pg Executing (default): SELECT "id", "username", "email", "passwordHash", "firstName", "lastName", "avatar", "bio", "phone", "status", "role", "approvalStatus", "approvedBy", "approvedAt", "rejectionReason", "emailVerified", "emailVerificationToken", "passwordResetToken", "passwordResetExpires", "failedLoginAttempts", "lockedUntil", "lastLoginAt", "publicKey", "createdAt", "updatedAt", "deletedAt" FROM "users" AS "User" WHERE ("User"."deletedAt" IS NULL AND ("User"."email" = 'admin' OR "User"."username" = 'admin')) LIMIT 1;
Executing (default): SELECT "id", "username", "email", "passwordHash", "firstName", "lastName", "avatar", "bio", "phone", "status", "role", "approvalStatus", "approvedBy", "approvedAt", "rejectionReason", "emailVerified", "emailVerificationToken", "passwordResetToken", "passwordResetExpires", "failedLoginAttempts", "lockedUntil", "lastLoginAt", "publicKey", "createdAt", "updatedAt", "deletedAt" FROM "users" AS "User" WHERE ("User"."deletedAt" IS NULL AND ("User"."email" = 'admin' OR "User"."username" = 'admin')) LIMIT 1;
2025-10-22T15:40:44.858Z sequelize:pool connection released
2025-10-22T15:40:44.858Z [[31merror[39m]: Login error: column "username" does not exist
{
  "name": "SequelizeDatabaseError",
  "parent": {
    "length": 108,
    "name": "error",
    "severity": "ERROR",
    "code": "42703",
    "position": "14",
    "file": "parse_relation.c",
    "line": "3665",
    "routine": "errorMissingColumn",
    "sql": "SELECT \"id\", \"username\", \"email\", \"passwordHash\", \"firstName\", \"lastName\", \"avatar\", \"bio\", \"phone\", \"status\", \"role\", \"approvalStatus\", \"approvedBy\", \"approvedAt\", \"rejectionReason\", \"emailVerified\", \"emailVerificationToken\", \"passwordResetToken\", \"passwordResetExpires\", \"failedLoginAttempts\", \"lockedUntil\", \"lastLoginAt\", \"publicKey\", \"createdAt\", \"updatedAt\", \"deletedAt\" FROM \"users\" AS \"User\" WHERE (\"User\".\"deletedAt\" IS NULL AND (\"User\".\"email\" = 'admin' OR \"User\".\"username\" = 'admin')) LIMIT 1;"
  },
  "original": {
    "length": 108,
    "name": "error",
    "severity": "ERROR",
    "code": "42703",
    "position": "14",
    "file": "parse_relation.c",
    "line": "3665",
    "routine": "errorMissingColumn",
    "sql": "SELECT \"id\", \"username\", \"email\", \"passwordHash\", \"firstName\", \"lastName\", \"avatar\", \"bio\", \"phone\", \"status\", \"role\", \"approvalStatus\", \"approvedBy\", \"approvedAt\", \"rejectionReason\", \"emailVerified\", \"emailVerificationToken\", \"passwordResetToken\", \"passwordResetExpires\", \"failedLoginAttempts\", \"lockedUntil\", \"lastLoginAt\", \"publicKey\", \"createdAt\", \"updatedAt\", \"deletedAt\" FROM \"users\" AS \"User\" WHERE (\"User\".\"deletedAt\" IS NULL AND (\"User\".\"email\" = 'admin' OR \"User\".\"username\" = 'admin')) LIMIT 1;"
  },
  "sql": "SELECT \"id\", \"username\", \"email\", \"passwordHash\", \"firstName\", \"lastName\", \"avatar\", \"bio\", \"phone\", \"status\", \"role\", \"approvalStatus\", \"approvedBy\", \"approvedAt\", \"rejectionReason\", \"emailVerified\", \"emailVerificationToken\", \"passwordResetToken\", \"passwordResetExpires\", \"failedLoginAttempts\", \"lockedUntil\", \"lastLoginAt\", \"publicKey\", \"createdAt\", \"updatedAt\", \"deletedAt\" FROM \"users\" AS \"User\" WHERE (\"User\".\"deletedAt\" IS NULL AND (\"User\".\"email\" = 'admin' OR \"User\".\"username\" = 'admin')) LIMIT 1;",
  "parameters": {},
  "stack": "Error\n    at Query.run (C:\\Users\\anton\\Documents\\messenger\\backend\\node_modules\\sequelize\\lib\\dialects\\postgres\\query.js:50:25)\n    at C:\\Users\\anton\\Documents\\messenger\\backend\\node_modules\\sequelize\\lib\\sequelize.js:315:28\n    at async PostgresQueryInterface.select (C:\\Users\\anton\\Documents\\messenger\\backend\\node_modules\\sequelize\\lib\\dialects\\abstract\\query-interface.js:407:12)\n    at async User.findAll (C:\\Users\\anton\\Documents\\messenger\\backend\\node_modules\\sequelize\\lib\\model.js:1140:21)\n    at async User.findOne (C:\\Users\\anton\\Documents\\messenger\\backend\\node_modules\\sequelize\\lib\\model.js:1240:12)\n    at async login (file:///C:/Users/anton/Documents/messenger/backend/src/controllers/authController.js:110:20)"
}
[2025-10-22 17:40:44] [91a3fb66-03f6-4552-8dda-b3474f192235] POST /api/auth/login 500 - 287ms - POST /api/auth/login
[0mPOST /api/auth/login [31m500[0m 286.035 ms - 95[0m
[2025-10-22 17:47:26] [1fbc6197-320b-4b6f-9c9a-4c9cd7ccfbc2] POST /api/auth/register 400 - 3ms - POST /api/auth/register
[0mPOST /api/auth/register [33m400[0m 2.873 ms - 249[0m
[2025-10-22 17:47:44] [3e603aaf-0c8f-489d-8cf3-57286f8381de] POST /api/auth/register 400 - 2ms - POST /api/auth/register
[0mPOST /api/auth/register [33m400[0m 1.265 ms - 249[0m
[2025-10-22 17:53:17] [0a465182-4fa6-4820-b42e-964f3cb8c774] POST /api/auth/login 400 - 3ms - POST /api/auth/login
[0mPOST /api/auth/login [33m400[0m 1.752 ms - 168[0m
2025-10-22T15:53:50.827Z sequelize:pool connection acquired
2025-10-22T15:53:50.828Z sequelize:sql:pg Executing (default): SELECT "id", "username", "email", "passwordHash", "firstName", "lastName", "avatar", "bio", "phone", "status", "role", "approvalStatus", "approvedBy", "approvedAt", "rejectionReason", "emailVerified", "emailVerificationToken", "passwordResetToken", "passwordResetExpires", "failedLoginAttempts", "lockedUntil", "lastLoginAt", "publicKey", "createdAt", "updatedAt", "deletedAt" FROM "users" AS "User" WHERE ("User"."deletedAt" IS NULL AND ("User"."email" = 'admin@messenger.local' OR "User"."username" = 'admin@messenger.local')) LIMIT 1;
Executing (default): SELECT "id", "username", "email", "passwordHash", "firstName", "lastName", "avatar", "bio", "phone", "status", "role", "approvalStatus", "approvedBy", "approvedAt", "rejectionReason", "emailVerified", "emailVerificationToken", "passwordResetToken", "passwordResetExpires", "failedLoginAttempts", "lockedUntil", "lastLoginAt", "publicKey", "createdAt", "updatedAt", "deletedAt" FROM "users" AS "User" WHERE ("User"."deletedAt" IS NULL AND ("User"."email" = 'admin@messenger.local' OR "User"."username" = 'admin@messenger.local')) LIMIT 1;
2025-10-22T15:53:50.830Z sequelize:pool connection released
2025-10-22T15:53:50.946Z sequelize:pool connection acquired
2025-10-22T15:53:50.947Z sequelize:sql:pg Executing (default): SELECT "id", "username", "email", "passwordHash", "firstName", "lastName", "avatar", "bio", "phone", "status", "role", "approvalStatus", "approvedBy", "approvedAt", "rejectionReason", "emailVerified", "emailVerificationToken", "passwordResetToken", "passwordResetExpires", "failedLoginAttempts", "lockedUntil", "lastLoginAt", "publicKey", "createdAt", "updatedAt", "deletedAt" FROM "users" AS "User" WHERE ("User"."deletedAt" IS NULL AND ("User"."email" = 'admin@messenger.local' OR "User"."username" = 'admin@messenger.local')) LIMIT 1;
Executing (default): SELECT "id", "username", "email", "passwordHash", "firstName", "lastName", "avatar", "bio", "phone", "status", "role", "approvalStatus", "approvedBy", "approvedAt", "rejectionReason", "emailVerified", "emailVerificationToken", "passwordResetToken", "passwordResetExpires", "failedLoginAttempts", "lockedUntil", "lastLoginAt", "publicKey", "createdAt", "updatedAt", "deletedAt" FROM "users" AS "User" WHERE ("User"."deletedAt" IS NULL AND ("User"."email" = 'admin@messenger.local' OR "User"."username" = 'admin@messenger.local')) LIMIT 1;
2025-10-22T15:53:50.948Z sequelize:pool connection released
2025-10-22T15:53:51.103Z sequelize:pool connection acquired
2025-10-22T15:53:51.103Z sequelize:sql:pg Executing (default): SELECT "id", "username", "email", "passwordHash", "firstName", "lastName", "avatar", "bio", "phone", "status", "role", "approvalStatus", "approvedBy", "approvedAt", "rejectionReason", "emailVerified", "emailVerificationToken", "passwordResetToken", "passwordResetExpires", "failedLoginAttempts", "lockedUntil", "lastLoginAt", "publicKey", "createdAt", "updatedAt", "deletedAt" FROM "users" AS "User" WHERE ("User"."deletedAt" IS NULL AND ("User"."email" = 'admin@messenger.local' OR "User"."username" = 'admin@messenger.local')) LIMIT 1;
Executing (default): SELECT "id", "username", "email", "passwordHash", "firstName", "lastName", "avatar", "bio", "phone", "status", "role", "approvalStatus", "approvedBy", "approvedAt", "rejectionReason", "emailVerified", "emailVerificationToken", "passwordResetToken", "passwordResetExpires", "failedLoginAttempts", "lockedUntil", "lastLoginAt", "publicKey", "createdAt", "updatedAt", "deletedAt" FROM "users" AS "User" WHERE ("User"."deletedAt" IS NULL AND ("User"."email" = 'admin@messenger.local' OR "User"."username" = 'admin@messenger.local')) LIMIT 1;
2025-10-22T15:53:51.105Z sequelize:pool connection released
2025-10-22T15:53:51.105Z [[31merror[39m]: Login error: column "username" does not exist
{
  "name": "SequelizeDatabaseError",
  "parent": {
    "length": 108,
    "name": "error",
    "severity": "ERROR",
    "code": "42703",
    "position": "14",
    "file": "parse_relation.c",
    "line": "3665",
    "routine": "errorMissingColumn",
    "sql": "SELECT \"id\", \"username\", \"email\", \"passwordHash\", \"firstName\", \"lastName\", \"avatar\", \"bio\", \"phone\", \"status\", \"role\", \"approvalStatus\", \"approvedBy\", \"approvedAt\", \"rejectionReason\", \"emailVerified\", \"emailVerificationToken\", \"passwordResetToken\", \"passwordResetExpires\", \"failedLoginAttempts\", \"lockedUntil\", \"lastLoginAt\", \"publicKey\", \"createdAt\", \"updatedAt\", \"deletedAt\" FROM \"users\" AS \"User\" WHERE (\"User\".\"deletedAt\" IS NULL AND (\"User\".\"email\" = 'admin@messenger.local' OR \"User\".\"username\" = 'admin@messenger.local')) LIMIT 1;"
  },
  "original": {
    "length": 108,
    "name": "error",
    "severity": "ERROR",
    "code": "42703",
    "position": "14",
    "file": "parse_relation.c",
    "line": "3665",
    "routine": "errorMissingColumn",
    "sql": "SELECT \"id\", \"username\", \"email\", \"passwordHash\", \"firstName\", \"lastName\", \"avatar\", \"bio\", \"phone\", \"status\", \"role\", \"approvalStatus\", \"approvedBy\", \"approvedAt\", \"rejectionReason\", \"emailVerified\", \"emailVerificationToken\", \"passwordResetToken\", \"passwordResetExpires\", \"failedLoginAttempts\", \"lockedUntil\", \"lastLoginAt\", \"publicKey\", \"createdAt\", \"updatedAt\", \"deletedAt\" FROM \"users\" AS \"User\" WHERE (\"User\".\"deletedAt\" IS NULL AND (\"User\".\"email\" = 'admin@messenger.local' OR \"User\".\"username\" = 'admin@messenger.local')) LIMIT 1;"
  },
  "sql": "SELECT \"id\", \"username\", \"email\", \"passwordHash\", \"firstName\", \"lastName\", \"avatar\", \"bio\", \"phone\", \"status\", \"role\", \"approvalStatus\", \"approvedBy\", \"approvedAt\", \"rejectionReason\", \"emailVerified\", \"emailVerificationToken\", \"passwordResetToken\", \"passwordResetExpires\", \"failedLoginAttempts\", \"lockedUntil\", \"lastLoginAt\", \"publicKey\", \"createdAt\", \"updatedAt\", \"deletedAt\" FROM \"users\" AS \"User\" WHERE (\"User\".\"deletedAt\" IS NULL AND (\"User\".\"email\" = 'admin@messenger.local' OR \"User\".\"username\" = 'admin@messenger.local')) LIMIT 1;",
  "parameters": {},
  "stack": "Error\n    at Query.run (C:\\Users\\anton\\Documents\\messenger\\backend\\node_modules\\sequelize\\lib\\dialects\\postgres\\query.js:50:25)\n    at C:\\Users\\anton\\Documents\\messenger\\backend\\node_modules\\sequelize\\lib\\sequelize.js:315:28\n    at async PostgresQueryInterface.select (C:\\Users\\anton\\Documents\\messenger\\backend\\node_modules\\sequelize\\lib\\dialects\\abstract\\query-interface.js:407:12)\n    at async User.findAll (C:\\Users\\anton\\Documents\\messenger\\backend\\node_modules\\sequelize\\lib\\model.js:1140:21)\n    at async User.findOne (C:\\Users\\anton\\Documents\\messenger\\backend\\node_modules\\sequelize\\lib\\model.js:1240:12)\n    at async login (file:///C:/Users/anton/Documents/messenger/backend/src/controllers/authController.js:110:20)"
}
[2025-10-22 17:53:51] [1ce176fb-18bd-4335-bf15-12c299773a0e] POST /api/auth/login 500 - 280ms - POST /api/auth/login
[0mPOST /api/auth/login [31m500[0m 280.141 ms - 95[0m
2025-10-22T15:56:20.756Z sequelize:connection:pg connection error 57P01
2025-10-22T15:56:20.757Z sequelize:pool connection destroy
2025-10-22T15:56:20.807Z sequelize:connection:pg connection timeout
2025-10-22T15:56:20.807Z sequelize:connection:pg connection timeout
