
[94m============================================================================[0m
[94m         ENHANCED MESSENGER API COMPREHENSIVE TEST SUITE (FIXED)[0m
[94m============================================================================[0m

Starting enhanced API tests at 23/10/2025 12:29:16.31
API URL: http://localhost:4000

[96m============================================================================[0m
[96mSECTION 1: HEALTH CHECK ENDPOINTS (4 endpoints)[0m
[96m============================================================================[0m

[1] Testing GET /health - Health Check
[91m✗ FAIL[0m - Health check endpoint failed [HTTP 429]

[2] Testing GET /health/detailed - Detailed Health Check
[91m✗ FAIL[0m - Detailed health check failed [HTTP 429]

[3] Testing GET /health/ready - Readiness Check
[91m✗ FAIL[0m - Readiness check failed [HTTP 429]

[4] Testing GET /health/live - Liveness Check
[91m✗ FAIL[0m - Liveness check failed [HTTP 429]

[96m============================================================================[0m
[96mSECTION 2: AUTHENTICATION ENDPOINTS (9 endpoints)[0m
[96m============================================================================[0m

[5] Testing POST /api/auth/register - User Registration
[91m✗ FAIL[0m - User registration failed [HTTP 429]

[6] Testing POST /api/auth/login - User Login
[91m✗ FAIL[0m - User login failed [HTTP 429]

[Secondary] Creating second test user for contact operations...
  [93mWarning: Second user creation failed [HTTP 429][0m
{"error":"Too many requests from this IP, please try again later."}
[7] Testing GET /api/auth/me - Get Current User Profile
[93m⊘ SKIP[0m - No access token available

[8] Testing POST /api/auth/refresh - Refresh Access Token
[93m⊘ SKIP[0m - No refresh token available

[9] Testing POST /api/auth/forgot-password - Request Password Reset
[93m⚠ CONDITIONAL[0m - Password reset request processed [HTTP 429]

[10] Testing POST /api/auth/verify-email - Verify Email
[93m⚠ CONDITIONAL[0m - Email verification endpoint accessible [HTTP 429]

[11] Testing POST /api/auth/reset-password - Reset Password
[93m⚠ CONDITIONAL[0m - Password reset endpoint accessible [HTTP 429]

[12] Testing POST /api/auth/change-password - Change Password
[93m⊘ SKIP[0m - Could not create test user for password change

[13] Testing POST /api/auth/resend-verification - Resend Verification
[93m⚠ CONDITIONAL[0m - Verification resend processed [HTTP 429]

[96m============================================================================[0m
[96mSECTION 3: USER MANAGEMENT ENDPOINTS (10 endpoints)[0m
[96m============================================================================[0m

[14] Testing GET /api/users/me - Get Current User Profile
[93m⊘ SKIP[0m - No access token available

[15] Testing PUT /api/users/me - Update User Profile
[93m⊘ SKIP[0m - No access token available

[16] Testing GET /api/users/search?q=test - Search Users
[93m⊘ SKIP[0m - No access token available

[17] Testing GET /api/users - List Users with Pagination
[91m✗ FAIL[0m - Failed to get user list [HTTP 429]

[18] Testing POST /api/users/me/avatar - Upload User Avatar
[93m⊘ SKIP[0m - No access token available

[19] Testing DELETE /api/users/me - Delete User Account
[93m⊘ SKIP[0m - No access token available

[20] Testing POST /api/users/me/device-token - Add Device Token
[93m⊘ SKIP[0m - No access token available

[21] Testing DELETE /api/users/me/device-token - Remove Device Token
[93m⊘ SKIP[0m - No access token available

[22] Testing GET /api/users/me/export - Export User Data
[93m⊘ SKIP[0m - No access token available

[23] Testing GET /api/users/{id} - Get User by ID
[93m⊘ SKIP[0m - No access token available

[96m============================================================================[0m
[96mSECTION 4: MESSAGING ENDPOINTS (9 endpoints)[0m
[96m============================================================================[0m

[24] Testing POST /api/messages - Send New Message
[93m⊘ SKIP[0m - No access token available

[25] Testing GET /api/messages?conversationWith={userId} - Get Conversation
[93m⊘ SKIP[0m - No access token available

[26] Testing GET /api/messages/search?q=test - Search Messages
[93m⊘ SKIP[0m - No access token available

[27] Testing GET /api/messages/conversations - Get Conversations List
[93m⊘ SKIP[0m - No access token available

[28] Testing POST /api/messages/{id}/read - Mark Message as Read
[93m⊘ SKIP[0m - No access token available

[29] Testing POST /api/messages/{id}/delivered - Mark Message as Delivered
[93m⊘ SKIP[0m - No access token available

[30] Testing PUT /api/messages/{id} - Edit Message
[93m⊘ SKIP[0m - No access token available

[31] Testing DELETE /api/messages/{id} - Delete Message
[93m⊘ SKIP[0m - No access token available

[32] Testing GET /api/messages/{id}/edit-history - Get Edit History
[93m⊘ SKIP[0m - No access token available

[96m============================================================================[0m
[96mSECTION 5: CONTACTS ENDPOINTS (6 endpoints)[0m
[96m============================================================================[0m

[33] Testing GET /api/contacts - Get Contacts List
[93m⊘ SKIP[0m - No access token available

[34] Testing GET /api/contacts/search?q=test - Search Contacts
[93m⊘ SKIP[0m - No access token available

[35] Testing POST /api/contacts - Add Contact
[93m⊘ SKIP[0m - No access token available

[36] Testing POST /api/contacts/{id}/block - Block Contact
[93m⊘ SKIP[0m - No access token available

[37] Testing POST /api/contacts/{id}/unblock - Unblock Contact
[93m⊘ SKIP[0m - No access token available

[38] Testing DELETE /api/contacts/{id} - Remove Contact
[93m⊘ SKIP[0m - No access token available

[96m============================================================================[0m
[96mSECTION 6: GROUPS ENDPOINTS (9 endpoints)[0m
[96m============================================================================[0m

[39] Testing GET /api/groups - Get User's Groups
[93m⊘ SKIP[0m - No access token available

[40] Testing POST /api/groups - Create New Group
[93m⊘ SKIP[0m - No access token available

[41] Testing GET /api/groups/{id} - Get Group Details
[93m⊘ SKIP[0m - No access token available

[42] Testing PUT /api/groups/{id} - Update Group
[93m⊘ SKIP[0m - No access token available

[43] Testing DELETE /api/groups/{id} - Delete Group
[93m⊘ SKIP[0m - No access token available

[44] Testing POST /api/groups/{id}/members - Add Group Member
[93m⊘ SKIP[0m - No access token available

[45] Testing GET /api/groups/{id}/members - Get Group Members
[93m⊘ SKIP[0m - No access token available

[46] Testing PUT /api/groups/{id}/members/{userId} - Update Member Role
[93m⊘ SKIP[0m - No access token available

[47] Testing DELETE /api/groups/{id}/members/{userId} - Remove Group Member
[93m⊘ SKIP[0m - No access token available

[96m============================================================================[0m
[96mSECTION 7: CALLS ENDPOINTS (4 endpoints)[0m
[96m============================================================================[0m

[48] Testing POST /api/calls - Initiate Call
[93m⊘ SKIP[0m - No access token available

[49] Testing POST /api/calls/{id}/respond - Respond to Call
[93m⊘ SKIP[0m - No access token available

[50] Testing GET /api/calls/{id} - Get Call Details
[93m⊘ SKIP[0m - No access token available

[51] Testing POST /api/calls/{id}/end - End Call
[93m⊘ SKIP[0m - No access token available

[96m============================================================================[0m
[96mSECTION 8: FILES ENDPOINTS (8 endpoints)[0m
[96m============================================================================[0m

[52] Testing GET /api/files - List User's Files
[93m⊘ SKIP[0m - No access token available

[53] Testing POST /api/files/upload - Upload File
[93m⊘ SKIP[0m - No access token available

[54] Testing GET /api/files/{id} - Download File
[93m⊘ SKIP[0m - No access token available

[55] Testing GET /api/files/{id}/info - Get File Info
[93m⊘ SKIP[0m - No access token available

[56] Testing GET /api/files/{id}/thumbnail - Get File Thumbnail
[93m⊘ SKIP[0m - No access token available

[57] Testing DELETE /api/files/{id} - Delete File
[93m⊘ SKIP[0m - No access token available

[58] Testing GET /api/admin/files - List All Files (Admin)
[93m⊘ SKIP[0m - No admin token available

[59] Testing DELETE /api/admin/files/{id} - Delete File (Admin)
[93m⊘ SKIP[0m - No admin token available

[96m============================================================================[0m
[96mSECTION 9: ENCRYPTION ENDPOINTS (4 endpoints)[0m
[96m============================================================================[0m

[60] Testing POST /api/encryption/keypair - Generate E2E Key Pair
[93m⊘ SKIP[0m - No access token available

[61] Testing GET /api/encryption/publickey/{userId} - Get Public Key
[93m⊘ SKIP[0m - No access token available

[62] Testing POST /api/encryption/publickeys/batch - Get Batch Public Keys
[93m⊘ SKIP[0m - No access token available

[63] Testing PUT /api/encryption/keypair - Update Key Pair
[93m⊘ SKIP[0m - No access token available

[96m============================================================================[0m
[96mSECTION 10: NOTIFICATIONS ENDPOINTS (7 endpoints)[0m
[96m============================================================================[0m

[64] Testing GET /api/notifications - Get User Notifications
\"; if ($n.Count -gt 0) { $n[0].id } } catch { '' }"' was unexpected at this time.
